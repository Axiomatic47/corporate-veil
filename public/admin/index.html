<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Content Manager</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  </head>
  <body>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    <script>
      // CMS Configuration
      const config = {
        load_config_file: false,
        backend: {
          name: window.location.hostname === 'localhost' ? 'proxy' : 'github',
          branch: 'main',
          repo: 'Axiomatic47/corporate-veil'
        },
        local_backend: window.location.hostname === 'localhost',
        media_folder: 'public/uploads',
        public_folder: '/uploads',
        publish_mode: 'simple',
        collections: [
          {
            name: 'memorandum',
            label: 'Memorandum',
            folder: 'content/compositions',
            create: true,
            slug: '{{year}}-{{month}}-{{day}}-{{slug}}',
            fields: [
              { label: 'Title', name: 'title', widget: 'string' },
              { label: 'Description', name: 'description', widget: 'text' },
              {
                label: 'Collection Type',
                name: 'collection_type',
                widget: 'select',
                options: ['memorandum', 'corrective'],
                required: true,
                default: 'memorandum'
              },
              { label: 'Section', name: 'section', widget: 'number', default: 1 },
              { label: 'Content', name: 'body', widget: 'markdown' }
            ],
            sortable_fields: ['title', 'description'],
            filter: {
              field: 'collection_type',
              value: 'memorandum'
            },
            preview: true,
            publish: true
          },
          {
            name: 'corrective',
            label: 'Corrective Measures',
            folder: 'content/compositions',
            create: true,
            slug: '{{year}}-{{month}}-{{day}}-{{slug}}',
            fields: [
              { label: 'Title', name: 'title', widget: 'string' },
              { label: 'Description', name: 'description', widget: 'text' },
              {
                label: 'Collection Type',
                name: 'collection_type',
                widget: 'select',
                options: ['memorandum', 'corrective'],
                required: true,
                default: 'corrective'
              },
              { label: 'Section', name: 'section', widget: 'number', default: 1 },
              { label: 'Content', name: 'body', widget: 'markdown' }
            ],
            sortable_fields: ['title', 'description'],
            filter: {
              field: 'collection_type',
              value: 'corrective'
            },
            preview: true,
            publish: true
          }
        ],
        display_url: window.location.origin,
        site_url: window.location.origin
      };

      // Initialize the CMS
      window.CMS.init({ config });
    </script>
  </body>
</html>